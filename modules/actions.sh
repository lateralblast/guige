#!/usr/bin/env bash

# shellcheck disable=SC2129
# shellcheck disable=SC2034

# Function: process_actions
#
# Process action switch

process_actions () {
  if [ "$ISO_ACTION" = "" ]; then
    warning_message "No action specified"
    exit
  fi
  case $ISO_ACTION in
    help|printhelp)
      print_help
      ;;
    usage|printusage)
      print_usage
      ;;
    checkracadm)
      DO_ISO_CHECKRACADM="true"
      ;;
    runracadm|execracadm|exectureracadm)
      DO_ISO_CHECKRACADM="true"
      DO_ISO_EXECUTERACADM="true"
      ;;
    listvm)
      DO_ISO_LISTVM="true"
      ;;
    createexport)
      DO_ISO_CHECKWORKDIR="true"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_CREATE_EXPORT="true"
      ;;
    createansible)
      DO_ISO_CHECKWORKDIR="true"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_CREATE_ANSIBLE="true"
      ;;
    runansible)
      DO_ISO_CHECKWORKDIR="true"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_CREATE_EXPORT="true"
      DO_CREATE_ANSIBLE="true"
      DO_INSTALL_SERVER="true"
      ;;
    printenv)
      DO_PRINT_ENV="true"
      ;;
    checkdocker)
      DO_ISO_DOCKER="false"
      DO_ISO_CHECKDOCKER="true"
      DO_ISO_CHECKWORKDIR="true"
      ;;
    getiso)
      DO_ISO_CHECKWORKDIR="true"
      DO_ISO_GETISO="true"
      ;;
    installrequired|checkrequired)
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      ;;
    checkworkdir|checkdirs)
      DO_ISO_CHECKWORKDIR="true"
      ;;
    justiso)
      DO_ISO_JUSTISO="true"
      ;;
    createautoinstall)
      DO_ISO_CREATEAUTOINSTALL="true"
      ;;
    runchrootscript|execchrootscript|executechrootscript)
      DO_ISO_RUNCHROOTSCRIPT="true"
      ;;
    createiso|fulliso)
      DO_ISO_CHECKWORKDIR="true"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_ISO_RUNCHROOTSCRIPT="true"
      DO_ISO_FULLISO="true"
      ;;
    createisoandsquashfs)
      DO_ISO_SQUASHFS_UPDATE="true"
      DO_ISO_CHECKWORKDIR="true"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_ISO_RUNCHROOTSCRIPT="true"
      DO_ISO_FULLISO="true"
     ;;
    createdockeriso)
      DO_ISO_DOCKER="true"
      DO_ISO_CHECKDOCKER="true"
      DO_ISO_CHECKWORKDIR="true"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_ISO_RUNCHROOTSCRIPT="true"
      DO_ISO_FULLISO="true"
      ;;
    createdockerisoandsquashfs)
      DO_ISO_SQUASHFS_UPDATE="true"
      DO_ISO_DOCKER="true"
      DO_ISO_CHECKDOCKER="true"
      DO_ISO_CHECKWORKDIR="true"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_ISO_RUNCHROOTSCRIPT="true"
      DO_ISO_FULLISO="true"
      ;;
    createisovm)
      VM_TYPE="kvm"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_ISO_CREATEISOVM="true"
      ;;
    deleteisovm)
      VM_TYPE="kvm"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_ISO_DELETEISOVM="true"
      ;;
    createcivm)
      VM_TYPE="kvm"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_ISO_CREATECIVM="true"
      ;;
    deletecivm)
      VM_TYPE="kvm"
      DO_ISO_INSTALLREQUIREDPACKAGES="true"
      DO_ISO_DELETECIVM="true"
      ;;
    queryiso)
      DO_ISO_QUERY="true"
      ;;
    unmount)
      DO_ISO_UNMOUNT="true"
      ;;
    oldinstaller)
      DO_ISO_OLDINSTALLER="true"
      ;;
    listalliso|listallisos|listiso|listisos)
      DO_ISO_LIST="true"
      ;;
    test)
      DO_TEST="true"
      ;;
    *)
      warning_message "Action \"$ISO_ACTION\" is not a valid action"
      exit
      ;;
  esac
  case $DELETE in
    files)
      FORCE_MODE="true"
      ;;
    all)
      FULL_FORCE_MODE="true"
      ;;
    *)
      FORCE_MODE="false"
      FULL_FORCE_MODE="false"
  esac
}
